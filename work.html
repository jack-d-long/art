<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Work</title>
  <style>
    :root {
      --ink: #333A3F;
      --paper: #fff;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: sans-serif;
      background: var(--paper);
      color: var(--ink);
    }

    .app {
      position: relative;
      min-height: 100vh;
      padding: 32px;
      isolation: isolate;
    }

    .menu-label {
      position: fixed;
      top: var(--origin-y, 50%);
      left: var(--label-x, 50%);
      transform: translate(-50%, -50%);
      z-index: 4;
      font-size: 12px;
      font-weight: 700;
      letter-spacing: 0.12em;
      text-transform: lowercase;
      color: var(--ink);
      transition: color 0.2s ease;
      cursor: pointer;
      user-select: none;
    }

    .menu-overlay {
      position: fixed;
      inset: 0;
      display: grid;
      place-items: center;
      clip-path: circle(0 at var(--origin-x, 50%) var(--origin-y, 50%));
      transition: clip-path 0.6s ease;
      pointer-events: none;
      background: transparent;
    }

    .app:has(.menu-label:hover) .menu-overlay,
    .app:has(.ray:hover) .menu-overlay {
      clip-path: circle(var(--reveal-radius, 75vmax) at var(--origin-x, 50%) var(--origin-y, 50%));
      pointer-events: auto;
    }

    .app:has(.menu-label:hover) .menu-label,
    .app:has(.ray:hover) .menu-label {
      color: var(--paper);
    }

    .menu-rays {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 5;
    }

    .ray {
      position: absolute;
      top: var(--origin-y, 50%);
      left: var(--origin-x, 50%);
      width: 60vmax;
      height: 18vmax;
      transform-origin: 0% 50%;
      clip-path: polygon(0 50%, 100% 0, 100% 100%);
      background: var(--ink);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--paper);
      font-size: 32px;
      text-decoration: none;
      pointer-events: auto;
      transition: opacity 0.2s ease;
    }

    .ray span {
      position: absolute;
      top: 50%;
      left: var(--label-x, 50%);
      transform: translate(-50%, -50%);
      white-space: nowrap;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      font-weight: 600;
    }

    .ray span.flip {
      transform: translate(-50%, -50%) rotate(180deg);
    }

    .ray:hover {
      opacity: 0.75;
    }

    @media (max-width: 900px) {
      .ray {
        height: 22vmax;
        width: 70vmax;
        font-size: 32px;
      }
    }

    @media (max-width: 600px) {
      .ray {
        height: 28vmax;
        width: 80vmax;
        font-size: 32px;
      }
    }
  </style>
</head>
<body>
  <div class="app" id="app">
    <div class="menu-label" aria-label="Menu trigger">work</div>

    <div class="menu-overlay" id="menu-overlay">
      <nav class="menu-rays" id="menu-rays" aria-label="Work menu"></nav>
    </div>
  </div>

  <script>
    // Configure 3-6 links; the number of links defines the number of rays.
    const menuLinks = [
      { label: "Photo", href: "photo.html" },
      { label: "About", href: "about.html" },
      { label: "Events", href: "events.html" },
      { label: "Exhibits", href: "exhibits.html" },
      { label: "Congresses", href: "congresses.html" },
      { label: "Sports", href: "sports.html" },
    ];

    const MIN_RAYS = 3;
    const MAX_RAYS = 6;
    const menu = document.getElementById("menu-rays");
    const app = document.getElementById("app");

    const links = menuLinks.slice(0, MAX_RAYS);
    if (links.length < MIN_RAYS) {
      console.warn(`Expected ${MIN_RAYS}-${MAX_RAYS} links. Found ${links.length}.`);
    }

    const count = links.length;
    const startAngle = 90;
    const endAngle = 270;
    const angleStep = count > 1 ? (endAngle - startAngle) / (count - 1) : 0;
    const angleGuard = 15;
    const minDeg = 90 / count;
    const maxDeg = 120 / count;

    const randBetween = (min, max) => min + Math.random() * (max - min);
    const originY = randBetween(33, 66);
    app.style.setProperty("--origin-y", `${originY}%`);
    const labelXPercent = ((window.innerWidth - 20) / window.innerWidth) * 100;
    app.style.setProperty("--label-x", `${labelXPercent}%`);

    const rays = [];

    const maxDistanceToCorner = (ox, oy, width, height) => {
      const corners = [
        [0, 0],
        [width, 0],
        [0, height],
        [width, height],
      ];
      return Math.max(
        ...corners.map(
          ([x, y]) => Math.hypot(x - ox, y - oy)
        )
      );
    };

    const layoutRays = () => {
      const vw = window.innerWidth;
      const vh = window.innerHeight;
      const originXPercent = ((vw + 20) / vw) * 100;
      app.style.setProperty("--origin-x", `${originXPercent}%`);
      const nextLabelX = ((vw - 20) / vw) * 100;
      app.style.setProperty("--label-x", `${nextLabelX}%`);
      const ox = (originXPercent / 100) * vw;
      const oy = (originY / 100) * vh;
      const rayLength = maxDistanceToCorner(ox, oy, vw, vh) + 40;
      app.style.setProperty("--reveal-radius", `${rayLength}px`);

      rays.forEach(({ link, thetaDeg, angle, label }) => {
        const theta = (thetaDeg * Math.PI) / 180;
        const height = 2 * rayLength * Math.tan(theta / 2);
        const rad = (angle * Math.PI) / 180;
        const dx = Math.cos(rad);
        const dy = Math.sin(rad);
        const candidates = [];

        if (dx !== 0) {
          const t1 = (0 - ox) / dx;
          const y1 = oy + t1 * dy;
          if (t1 > 0 && y1 >= 0 && y1 <= vh) candidates.push(t1);

          const t2 = (vw - ox) / dx;
          const y2 = oy + t2 * dy;
          if (t2 > 0 && y2 >= 0 && y2 <= vh) candidates.push(t2);
        }

        if (dy !== 0) {
          const t3 = (0 - oy) / dy;
          const x3 = ox + t3 * dx;
          if (t3 > 0 && x3 >= 0 && x3 <= vw) candidates.push(t3);

          const t4 = (vh - oy) / dy;
          const x4 = ox + t4 * dx;
          if (t4 > 0 && x4 >= 0 && x4 <= vw) candidates.push(t4);
        }

        const edgeDist = candidates.length ? Math.min(...candidates) : rayLength;
        const labelX = edgeDist / 2;

        link.style.width = `${rayLength}px`;
        link.style.height = `${height}px`;
        link.style.transform = `translate(0, -50%) rotate(${angle}deg)`;
        label.style.setProperty("--label-x", `${labelX}px`);
      });
    };

    links.forEach((item, index) => {
      const rawAngle = startAngle + angleStep * index;
      const angle = Math.min(endAngle - angleGuard, Math.max(startAngle + angleGuard, rawAngle));
      const thetaDeg = minDeg + Math.random() * (maxDeg - minDeg);
      const link = document.createElement("a");
      link.className = "ray";
      link.href = item.href;
      link.style.transform = `translate(0, -50%) rotate(${angle}deg)`;
      const label = document.createElement("span");
      label.textContent = item.label;
      link.appendChild(label);
      if (angle >= 90 && angle <= 270) {
        label.classList.add("flip");
      }
      menu.appendChild(link);
      rays.push({ link, thetaDeg, angle, label });
    });

    layoutRays();
    window.addEventListener("resize", layoutRays);
  </script>
</body>
</html>
